# üìÖ Day 04 (2025-07-31, Thu)

## üéì What I Did Today

**üìå I shared updates on the JWT authentication system implementation and its current status during the morning development meeting, also receiving a new requirement for dynamically changing PDF cover images.**   
**üìå I thoroughly stabilized the JWT authentication system by resolving key bugs, including the CSRF token issue, and refining the token generation logic.**   
**üìå I analyzed and planned solutions for server resource issues in the cPanel deployment environment, and implemented optimization strategies for multi-language fonts and CSS in `xhtml2pdf`.**  

### Detailed Activities

Today's development work focused on a morning meeting, stabilizing the JWT authentication system, optimizing the cPanel deployment environment, and enhancing the PDF generation system.

**1. Development Meeting & New Requirements**

-   **Status Report**:
    
    -   **JWT Authentication System Implemented:** I reported the successful transition from Flask sessions to a JWT token-based security approach.
        
    -   **CSRF Token Issue Resolved:** I confirmed that the 'CSRF double submit tokens do not match' error and the `getCsrfToken()` function's token mix-up issue from yesterday (July 30) were completely resolved.
        
    -   **System Stabilization:** I verified that all core dashboard functionalities, including JWT authentication, CSRF protection, and PDF generation, are now operating correctly.
        
-   **Senior Developer Feedback**:
    
    -   The implemented **JWT approach was approved**, and it was confirmed that the system is ready for testing.
        
    -   I was asked to continue incorporating previous feedback on **AI summarization and PDF output text content improvements**.
        
    -   A **new requirement for a dynamic PDF cover image system** was introduced (using WordPress-sourced images as backgrounds instead of CSS colors, with existing content overlaid).
        
    -   With no immediate new tasks, I was instructed to continue modifying and improving the report dashboard project.
        

**2. Full Stabilization of JWT Authentication System üîê**

-   **A. Complete Resolution of CSRF Token Issue**
    
    -   **Core Problem:** The `JWT_COOKIE_HTTPONLY = True` setting caused the `csrf_access_token` cookie to also become HttpOnly, preventing JavaScript access. This led to `getCsrfToken()` returning `null` and "Missing CSRF token" errors from the server.
        
    -   **Perfect Solution:** By setting `app.config["JWT_CSRF_COOKIE_HTTPONLY"] = False`, I allowed JavaScript access to the CSRF token while keeping the Access Token HttpOnly, establishing a **dual-layer security system** against XSS and CSRF attacks.
        
    -   **Result:** Verified successful implementation by observing `[CSRF DEBUG] Found CSRF token:` messages.
        
-   **B. Token Generation Bug Fix**
    
    -   **Root Cause Discovered:** A bug was found where the 'type' attribute of a Refresh Token was copied when generating a new Access Token, leading to an "Only non-refresh tokens are allowed" error and an infinite 401 error loop.
        
    -   **Solution:** I filtered **JWT reserved claims (`RESERVED_CLAIMS = {"sub", "exp", "iat", "nbf", "jti", "aud", "iss", "type"}`)** to prevent the 'type' attribute of the Refresh Token from being copied to the new Access Token.
        

**3. cPanel Environment Optimization üñ•Ô∏è**

-   **A. Server Resource Issue Analysis & Solution Planning (Testing Scheduled for Tomorrow)**
    
    -   **Problem Discovered:** Repeated process killing (`Child process was killed by signal: 15`) occurred on cPanel.
        
    -   **Root Cause Analysis:** Overuse of server resources during Google Analytics OAuth authentication, excessive data requests from WordPress API (`per_page=100`), and memory overuse due to debug mode being active in the production environment were identified as primary causes.
        
    -   **Solution Plan:** I've implemented code to activate debug mode only in the development environment, reduced WordPress API `per_page` to 10 and `timeout` to 5 seconds, and adjusted logging levels to `WARNING`. This will be tested tomorrow.
        
-   **B. GA4 Authentication Strategy Improvement Plan (Not Yet Implemented)**
    
    -   **Proposed Solution:** The strategy involves performing OAuth authentication locally to generate a light `credentials.json` file, then uploading only this file to the server to minimize server resource burden.
        

**4. PDF Generation System Enhancements üìÑ**

-   **A. `xhtml2pdf` Optimization Implementation (Improved Version Not Yet Tested)**
    
    -   **Problems Discovered:** During PDF generation, issues like 'Arial' font not found, incorrect percentage sizing (`100%`) in CSS, and CSS syntax errors were encountered with `xhtml2pdf`.
        
    -   **Solution Implemented:** I added an HTML pre-processing function to `pdf_generator.py` to convert percentage sizes to fixed dimensions (e.g., A3 landscape), replace 'Arial' with `xhtml2pdf`-compatible fonts (`"DejaVu Sans", "Liberation Sans", sans-serif`), and automatically correct CSS syntax errors. This is yet to be tested.
        
-   **B. Dynamic Cover Image System Design**
    
    -   **WordPress Integration Concept:** The plan is to utilize the Enhanced Media Library plugin in WordPress to randomly fetch cover images from a "PDF Report Covers" category.
        

**5. Initialization Timing Issue Resolution ‚ö°**

-   **Problem:** API calls failed on the first access but succeeded after a refresh.
    
-   **Root Cause:** This was due to a timing difference between when the server issued the `Set-Cookie` header and the browser processed it for JavaScript access, and when `main.js` made its initial API call.
    
-   **Solution Strategy:** I added a `waitForJWTCookie()` function to `main.js`. This JavaScript logic waits for the JWT cookie to be fully loaded in the browser before proceeding with initial API calls, ensuring stability.


## üß† Key Concepts Learned

-   **Deeper Understanding of JWT-based Authentication System**: I gained a clear understanding of practical applications of `HttpOnly`, `SameSite=Strict`, `Secure` cookie options, and the mechanism of controlling JavaScript access to CSRF tokens via `JWT_CSRF_COOKIE_HTTPONLY` settings. This experience solidified the importance of **building a dual-layer security system** to defend against both XSS and CSRF attacks.
    
-   **Debugging Strategies in Complex Server Environments**: I learned to analyze the root causes of unpredictable server resource issues (like `Child process was killed`) in constrained shared hosting environments like cPanel. This involved multi-faceted analysis (e.g., Google Analytics OAuth, WordPress API calls, Debug Mode activation) and **developing the ability to devise solutions through environment variable and code optimization**.
    
-   **Importance of Font Management for Multi-Language PDF Generation**: I recognized the multi-language text corruption issue in PDF generation from libraries like `xhtml2pdf` due to the **lack of automatic font substitution in server environments**. This highlighted the necessity of **directly including and explicitly specifying integrated fonts (like Noto Sans)** for comprehensive language support.


## üí° Practical Trial-and-Error and Tips

-   **Subtle Differences in `Flask-JWT-Extended` CSRF Protection Settings**: I initially faced CSRF token access issues by confusing `JWT_COOKIE_HTTPONLY` and `JWT_CSRF_COOKIE_HTTPONLY`. The key is to **keep Access Tokens HttpOnly for XSS protection, but explicitly set `JWT_CSRF_COOKIE_HTTPONLY = False` to allow JavaScript access for CSRF tokens**.
    
-   **Necessity of `Flask-JWT-Extended` Token Claim Filtering**: Generating new Access Tokens from Refresh Tokens sometimes copied the `type` claim, leading to an "Only non-refresh tokens are allowed" error. It's crucial to **filter out unnecessary JWT reserved claims (`RESERVED_CLAIMS`) from being included in reissued tokens**.
    
-   **Environment-Independent `xhtml2pdf` Optimization**: PDF generation often encounters issues with `width: 100%` CSS percentages or font rendering. To ensure stable PDF generation regardless of the environment, it's vital to **preprocess HTML to convert percentages to fixed units (e.g., `mm`) and explicitly specify multi-language supporting fonts (e.g., Noto Sans)**.
    
-   **Resolving Client-Server Initialization Timing Issues**: Initial API call failures on first access often stem from the time lag between the server issuing cookies and the browser fully processing them for JavaScript access. Implementing a **JavaScript logic (e.g., `waitForJWTCookie`) that waits for necessary cookies to load by checking `document.cookie`** can significantly improve the stability of initial API calls.


## üîú Next Steps

-   **Complete PDF Multi-Language Font Support System**: I will upload the planned Noto Sans font files to the server and modify `pdf_generator.py` to **ensure multi-language (including Korean and Chinese) text is displayed correctly and without corruption in generated PDFs**.
    
-   **Test cPanel Server Resource Optimization Results**: I will thoroughly test and verify whether the changes applied today (debug mode, WordPress API call settings, logging level adjustments) **effectively reduce server resource usage and resolve process killing issues in the cPanel environment**.
    
-   **Begin Dynamic PDF Cover Image System Development**: Following the senior developer's feedback, I will start implementing the **dynamic cover image system** that fetches images from WordPress to use as PDF cover backgrounds, replacing the current CSS background color method.
    
-   **Incorporate AI Summary & PDF Text Content Feedback**: I will specifically review and implement the previously received feedback for improving the AI summarization feature and the quality of text content within generated PDFs.
    
-   **Final Integrated Testing of Flask App and WP**: Once all feature implementations are complete, I will conduct comprehensive integrated testing of the WP login integration and all Flask app functionalities to ensure final stability.

----------

# üìÖ 4ÏùºÏ∞® (2025-07-31, Î™©)

## üéì Ïò§Îäò Ìïú Ïùº

**üìå Ïò§Ï†Ñ Í∞úÎ∞ú ÎØ∏ÌåÖÏóêÏÑú JWT Ïù∏Ï¶ù ÏãúÏä§ÌÖú Íµ¨ÌòÑ ÏôÑÎ£å Î∞è ÌòÑÌô©ÏùÑ Í≥µÏú†ÌïòÍ≥†, PDF Ïª§Î≤Ñ Ïù¥ÎØ∏ÏßÄ ÎèôÏ†Å Î≥ÄÍ≤Ω ÏãúÏä§ÌÖú Íµ¨Ï∂ïÏóê ÎåÄÌïú ÏÉàÎ°úÏö¥ ÏöîÍµ¨ÏÇ¨Ìï≠ÏùÑ Ï†ÑÎã¨Î∞õÏïòÏäµÎãàÎã§.**   
**üìå JWT Ïù∏Ï¶ù ÏãúÏä§ÌÖúÏùò CSRF ÌÜ†ÌÅ∞ Î¨∏Ï†úÎ•º Ìè¨Ìï®Ìïú Ï£ºÏöî Î≤ÑÍ∑∏Î•º Ìï¥Í≤∞ÌïòÍ≥†, ÌÜ†ÌÅ∞ ÏÉùÏÑ± Î°úÏßÅÏùÑ Í∞úÏÑ†ÌïòÏó¨ ÏãúÏä§ÌÖúÏùÑ ÏôÑÎ≤ΩÌïòÍ≤å ÏïàÏ†ïÌôîÌñàÏäµÎãàÎã§.**   
**üìå cPanel Î∞∞Ìè¨ ÌôòÍ≤ΩÏóêÏÑúÏùò ÏÑúÎ≤Ñ Î¶¨ÏÜåÏä§ Î¨∏Ï†ú Î∂ÑÏÑù Î∞è Ìï¥Í≤∞ Î∞©ÏïàÏùÑ Î™®ÏÉâÌñàÏúºÎ©∞, `xhtml2pdf`Ïùò Îã§Íµ≠Ïñ¥ Ìè∞Ìä∏ Î∞è CSS ÏµúÏ†ÅÌôî Î∞©ÏïàÏùÑ Íµ¨ÌòÑÌñàÏäµÎãàÎã§.**  

### ÏÉÅÏÑ∏ ÌôúÎèô

Ïò§Îäò ÌïòÎ£® ÎèôÏïà ÏßÑÌñâÎêú Í∞úÎ∞ú ÎØ∏ÌåÖ ÎÇ¥Ïö©Í≥º JWT Ïù∏Ï¶ù ÏãúÏä§ÌÖú Î¨∏Ï†ú Ìï¥Í≤∞, cPanel Î∞∞Ìè¨ ÌôòÍ≤Ω ÏµúÏ†ÅÌôî, Í∑∏Î¶¨Í≥† PDF ÏÉùÏÑ± ÏãúÏä§ÌÖú Í∞úÏÑ† Í≥ºÏ†ïÏùÑ Ï§ëÏöîÌïú Ïù¥Ïäà Ï§ëÏã¨ÏúºÎ°ú ÏÉÅÏÑ∏Ìûà Ï†ïÎ¶¨ÌñàÏäµÎãàÎã§.

**1. Í∞úÎ∞ú ÎØ∏ÌåÖ ÎÇ¥Ïö© Í≥µÏú† Î∞è ÏÉàÎ°úÏö¥ ÏöîÍµ¨ÏÇ¨Ìï≠ ÌôïÏù∏**

-   **Î≥¥Í≥† ÏÇ¨Ìï≠**:
    
    -   **JWT Ïù∏Ï¶ù ÏãúÏä§ÌÖú Íµ¨ÌòÑ ÏôÑÎ£å:** Í∏∞Ï°¥ Flask ÏÑ∏ÏÖò Î∞©ÏãùÏóêÏÑú JWT ÌÜ†ÌÅ∞ Í∏∞Î∞òÏúºÎ°ú Î≥¥Ïïà Ï†ëÍ∑ºÎ≤ïÏùÑ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÑÌôòÌñàÏùåÏùÑ Î≥¥Í≥†ÌñàÏäµÎãàÎã§.
        
    -   **CSRF ÌÜ†ÌÅ∞ Î¨∏Ï†ú Ìï¥Í≤∞:** Ïñ¥Ï†ú(7Ïõî 30Ïùº) Î∞úÏÉùÌñàÎçò 'CSRF double submit tokens do not match' Î¨∏Ï†úÏôÄ `getCsrfToken()` Ìï®Ïàò ÌÜ†ÌÅ∞ ÌòºÏö© Î¨∏Ï†úÎ•º ÏôÑÏ†ÑÌûà Ìï¥Í≤∞ÌñàÏùåÏùÑ Î∞ùÌòîÏäµÎãàÎã§.
        
    -   **ÏãúÏä§ÌÖú ÏïàÏ†ïÌôî:** ÌòÑÏû¨ JWT Ïù∏Ï¶ù, CSRF Î≥¥Ìò∏, PDF ÏÉùÏÑ± Îì± ÎåÄÏãúÎ≥¥ÎìúÏùò Î™®Îì† ÌïµÏã¨ Í∏∞Îä•Ïù¥ Ï†ïÏÉÅÏ†ÅÏúºÎ°ú ÏûëÎèôÌïòÍ≥† ÏûàÏùåÏùÑ ÌôïÏù∏ÌñàÏäµÎãàÎã§.
        
-   **Í∞úÎ∞ú ÏÑ†ÏûÑ ÌîºÎìúÎ∞±**:
    
    -   ÌòÑÏû¨ Íµ¨ÌòÑÎêú **JWT Î∞©ÏãùÏùò Î∞©Ìñ•ÏÑ±Ïù¥ ÏäπÏù∏**ÎêòÏóàÍ≥†, ÌÖåÏä§Ìä∏ ÏßÑÌñâÏù¥ Í∞ÄÎä•Ìïú ÏÉÅÌÉúÏûÑÏùÑ ÌôïÏù∏Î∞õÏïòÏäµÎãàÎã§.
        
    -   **AI ÏöîÏïΩ Î∞è PDF Í≤∞Í≥ºÎ¨º ÌÖçÏä§Ìä∏ ÏΩòÌÖêÏ∏† Í∞úÏÑ†**Ïóê ÎåÄÌïú Í∏∞Ï°¥ ÌîºÎìúÎ∞±Îì§ÏùÑ Í≥ÑÏÜç Î∞òÏòÅÌï¥Îã¨ÎùºÎäî ÏöîÏ≤≠ÏùÑ Î∞õÏïòÏäµÎãàÎã§.
        
    -   **ÏÉàÎ°úÏö¥ ÏöîÍµ¨ÏÇ¨Ìï≠:** **PDF Ïª§Î≤Ñ Ïù¥ÎØ∏ÏßÄ ÎèôÏ†Å Î≥ÄÍ≤Ω ÏãúÏä§ÌÖú** Íµ¨Ï∂ïÏóê ÎåÄÌïú ÌîºÎìúÎ∞±ÏùÑ Î∞õÏïòÏäµÎãàÎã§. (CSS Î∞∞Í≤ΩÏÉâ ÎåÄÏã† WordPressÏóêÏÑú Í∞ÄÏ†∏Ïò® Ïù¥ÎØ∏ÏßÄÎ•º Î∞∞Í≤ΩÏúºÎ°ú ÏÇ¨Ïö©ÌïòÍ≥†, Í∑∏ ÏúÑÏóê Í∏∞Ï°¥ ÏΩòÌÖêÏ∏†Î•º Ïò§Î≤ÑÎ†àÏù¥ÌïòÎäî Î∞©Ïãù).
        
    -   ÌòÑÏû¨Îäî Ï∂îÍ∞ÄÎ°ú Îß°Í∏∏ ÏóÖÎ¨¥Í∞Ä ÏóÜÏúºÎØÄÎ°ú, Î¶¨Ìè¨Ìä∏ ÎåÄÏãúÎ≥¥Îìú ÌîÑÎ°úÏ†ùÌä∏Ïùò ÏàòÏ†ï Î∞è Í∞úÏÑ† ÏûëÏóÖÏùÑ Í≥ÑÏÜç ÏßÑÌñâÌï¥Îã¨ÎùºÎäî ÏßÄÏãúÎ•º Î∞õÏïòÏäµÎãàÎã§.
        

**2. JWT Ïù∏Ï¶ù ÏãúÏä§ÌÖú ÏôÑÏ†Ñ ÏïàÏ†ïÌôî üîê**

-   **A. CSRF ÌÜ†ÌÅ∞ Î¨∏Ï†ú ÏôÑÏ†Ñ Ìï¥Í≤∞**
    
    -   **Î¨∏Ï†úÏùò ÌïµÏã¨:** `JWT_COOKIE_HTTPONLY = True` ÏÑ§Ï†ïÏúºÎ°ú Ïù∏Ìï¥ `csrf_access_token` Ïø†ÌÇ§ÎèÑ HttpOnlyÍ∞Ä ÎêòÏñ¥ JavaScript Ï†ëÍ∑ºÏù¥ Î∂àÍ∞ÄÎä•ÌñàÎçò Î¨∏Ï†úÍ∞Ä ÏûàÏóàÏäµÎãàÎã§. Ïù¥Î°ú Ïù∏Ìï¥ `getCsrfToken()` Ìï®ÏàòÍ∞Ä `null`ÏùÑ Î∞òÌôòÌïòÍ≥† ÏÑúÎ≤ÑÏóêÏÑú "Missing CSRF token" ÏóêÎü¨Í∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.
        
    -   **ÏôÑÎ≤ΩÌïú Ìï¥Í≤∞Ï±Ö:** `app.config["JWT_CSRF_COOKIE_HTTPONLY"] = False`Î°ú ÏÑ§Ï†ïÌïòÏó¨ CSRF ÌÜ†ÌÅ∞ÏùÄ JavaScript Ï†ëÍ∑ºÏùÑ ÌóàÏö©ÌïòÍ≥†, Access TokenÏùÄ HttpOnlyÎ°ú Ïú†ÏßÄÌïòÏó¨ XSS Í≥µÍ≤©ÏùÑ Î∞©Ïñ¥ÌïòÎäî **Ïù¥Ï§ë Î≥¥Ïïà ÏãúÏä§ÌÖúÏùÑ Íµ¨Ï∂ï**ÌñàÏäµÎãàÎã§.
        
    -   **Í≤∞Í≥º:** `[CSRF DEBUG] Found CSRF token:` Î©îÏãúÏßÄ ÌôïÏù∏ÏúºÎ°ú ÏôÑÎ≤ΩÌïú ÏÑ±Í≥µÏùÑ Í≤ÄÏ¶ùÌñàÏäµÎãàÎã§.
        
-   **B. ÌÜ†ÌÅ∞ ÏÉùÏÑ± Î≤ÑÍ∑∏ ÏàòÏ†ï**
    
    -   **Î∞úÍ≤¨Îêú Í∑ºÎ≥∏Ï†Å Î¨∏Ï†ú:** ÏÑúÎ≤ÑÏóêÏÑú Refresh TokenÏúºÎ°ú ÏÉà Access TokenÏùÑ ÏÉùÏÑ±Ìï† Îïå, Refresh TokenÏùò 'type' ÏÜçÏÑ±ÍπåÏßÄ Î≥µÏÇ¨ÎêòÎäî Î≤ÑÍ∑∏Í∞Ä Î∞úÍ≤¨ÎêòÏñ¥ "Only non-refresh tokens are allowed" ÏóêÎü¨Í∞Ä Î∞úÏÉùÌïòÍ≥† Î¨¥Ìïú 401 ÏóêÎü¨ Î£®ÌîÑÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.
        
    -   **Ìï¥Í≤∞Ï±Ö:** JWT ÏòàÏïΩ ÌÅ¥Î†àÏûÑ(`RESERVED_CLAIMS = {"sub", "exp", "iat", "nbf", "jti", "aud", "iss", "type"}`)ÏùÑ ÌïÑÌÑ∞ÎßÅÌïòÏó¨ Refresh TokenÏùò 'type' ÏÜçÏÑ±Ïù¥ ÏÉà Access TokenÏóê Î≥µÏÇ¨ÎêòÏßÄ ÏïäÎèÑÎ°ù ÏàòÏ†ïÌñàÏäµÎãàÎã§.
        

**3. cPanel ÌôòÍ≤Ω ÏµúÏ†ÅÌôî üñ•Ô∏è**

-   **A. ÏÑúÎ≤Ñ Î¶¨ÏÜåÏä§ Î¨∏Ï†ú Î∂ÑÏÑù Î∞è Ìï¥Í≤∞ Î∞©Ïïà Î™®ÏÉâ (ÎÇ¥Ïùº ÌÖåÏä§ÌåÖ ÏòàÏ†ï)**
    
    -   **Î∞úÍ≤¨Îêú Î¨∏Ï†ú:** cPanelÏóêÏÑú ÌîÑÎ°úÏÑ∏Ïä§ ÌÇ¨ÎßÅ(`Child process was killed by signal: 15`)Ïù¥ Î∞òÎ≥µÏ†ÅÏúºÎ°ú Î∞úÏÉùÌñàÏäµÎãàÎã§.
        
    -   **ÏõêÏù∏ Î∂ÑÏÑù:** Google Analytics OAuth Ïù∏Ï¶ù Í≥ºÏ†ïÏùò Í≥ºÎèÑÌïú Î¶¨ÏÜåÏä§ ÏÜåÎ™®, WordPress APIÏùò Í≥ºÎèÑÌïú Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠(`per_page=100`), Í∑∏Î¶¨Í≥† Ïö¥ÏòÅ ÌôòÍ≤ΩÏóêÏÑú ÎîîÎ≤ÑÍ∑∏ Î™®Îìú ÌôúÏÑ±ÌôîÎ°ú Ïù∏Ìïú Î©îÎ™®Î¶¨ Í≥ºÏÇ¨Ïö©Ïù¥ Ï£º ÏõêÏù∏Ïù¥ÏóàÏäµÎãàÎã§.
        
    -   **Ìï¥Í≤∞ Î∞©Ïïà:** ÎîîÎ≤ÑÍ∑∏ Î™®ÎìúÎ•º Í∞úÎ∞ú ÌôòÍ≤ΩÏóêÏÑúÎßå ÌôúÏÑ±ÌôîÌïòÍ≥†, WordPress API `per_page` Í∞íÏùÑ 10ÏúºÎ°ú, `timeout`ÏùÑ 5Ï¥àÎ°ú Îã®Ï∂ï, Î°úÍπÖ Î†àÎ≤®ÏùÑ `WARNING`ÏúºÎ°ú Ï°∞Ï†ïÌïòÎäî ÏΩîÎìúÎ•º Íµ¨ÌòÑÌñàÏúºÎ©∞, Ïù¥ Î∂ÄÎ∂ÑÏùÄ ÎÇ¥Ïùº ÌÖåÏä§Ìä∏Ìï† ÏòàÏ†ïÏûÖÎãàÎã§.
        
-   **B. GA4 Ïù∏Ï¶ù Ï†ÑÎûµ Í∞úÏÑ† Íµ¨ÏÉÅ (ÏïÑÏßÅ Î∞òÏòÅ Ï†Ñ)**
    
    -   **Ï†úÏïàÎêú Ìï¥Í≤∞Ï±Ö:** Î°úÏª¨ÏóêÏÑú OAuth Ïù∏Ï¶ùÏùÑ ÏàòÌñâÌïòÏó¨ Í∞ÄÎ≤ºÏö¥ `credentials.json` ÌååÏùºÎßå ÏÑúÎ≤ÑÏóê ÏóÖÎ°úÎìúÌï®ÏúºÎ°úÏç® ÏÑúÎ≤Ñ Î¶¨ÏÜåÏä§ Î∂ÄÎã¥ÏùÑ ÏµúÏÜåÌôîÌïòÎäî Ï†ÑÎûµÏùÑ Íµ¨ÏÉÅÌñàÏäµÎãàÎã§.
        

**4. PDF ÏÉùÏÑ± ÏãúÏä§ÌÖú Í∞úÏÑ† üìÑ**

-   **A. xhtml2pdf ÏµúÏ†ÅÌôî Íµ¨ÌòÑ (Í∞úÏÑ† Î≤ÑÏ†Ñ ÏïÑÏßÅ ÌÖåÏä§ÌåÖ Ï†Ñ)**
    
    -   **Î∞úÍ≤¨Îêú Î¨∏Ï†úÎì§:** PDF ÏÉùÏÑ± Ïãú 'Arial' Ìè∞Ìä∏ ÎØ∏ÏßÄÏõê, `100%` Í∞ôÏùÄ Î∞±Î∂ÑÏú® ÌÅ¨Í∏∞ Ïò§Î•ò, CSS Íµ¨Î¨∏ Ïò§Î•ò Îì± `xhtml2pdf` Í¥ÄÎ†® Î¨∏Ï†úÎì§Ïù¥ ÏûàÏóàÏäµÎãàÎã§.
        
    -   **Ìï¥Í≤∞Ï±Ö Íµ¨ÌòÑ:** `pdf_generator.py`Ïóê HTML Ï†ÑÏ≤òÎ¶¨ Ìï®ÏàòÎ•º Ï∂îÍ∞ÄÌïòÏó¨ Î∞±Î∂ÑÏú® ÌÅ¨Í∏∞Î•º Í≥†Ï†ï ÌÅ¨Í∏∞(A3 Í∞ÄÎ°ú Í∏∞Ï§Ä)Î°ú Î≥ÄÍ≤ΩÌïòÍ≥†, `Arial` Ìè∞Ìä∏Î•º `xhtml2pdf` Ìò∏Ìôò Ìè∞Ìä∏(`"DejaVu Sans", "Liberation Sans", sans-serif`)Î°ú ÎåÄÏ≤¥ÌïòÎ©∞, CSS Íµ¨Î¨∏ Ïò§Î•òÎ•º ÏûêÎèô ÏàòÏ†ïÌïòÎèÑÎ°ù Íµ¨ÌòÑÌñàÏäµÎãàÎã§. Ïù¥ Î∂ÄÎ∂ÑÏùÄ ÏïÑÏßÅ ÌÖåÏä§Ìä∏ Ï†ÑÏûÖÎãàÎã§.
        
-   **B. ÎèôÏ†Å Ïª§Î≤Ñ Ïù¥ÎØ∏ÏßÄ ÏãúÏä§ÌÖú ÏÑ§Í≥Ñ**
    
    -   **WordPress Ïó∞Îèô ÏãúÏä§ÌÖú Íµ¨ÏÉÅ:** Enhanced Media Library ÌîåÎü¨Í∑∏Ïù∏ÏùÑ ÌôúÏö©ÌïòÏó¨ WordPressÏùò "PDF Report Covers" Ïπ¥ÌÖåÍ≥†Î¶¨ÏóêÏÑú ÎûúÎç§ÏúºÎ°ú Ïª§Î≤Ñ Ïù¥ÎØ∏ÏßÄÎ•º Í∞ÄÏ†∏Ïò§Îäî ÏãúÏä§ÌÖúÏùÑ Íµ¨ÏÉÅÌñàÏäµÎãàÎã§.
        

**5. Ï¥àÍ∏∞Ìôî ÌÉÄÏù¥Î∞ç Î¨∏Ï†ú Ìï¥Í≤∞ ‚ö°**

-   **Î¨∏Ï†ú ÏÉÅÌô©:** Ï≤´ Ï†ëÏÜç Ïãú API Ìò∏Ï∂úÏù¥ Ïã§Ìå®ÌïòÍ≥† ÏÉàÎ°úÍ≥†Ïπ® ÌõÑÏóêÎäî ÏÑ±Í≥µÌïòÎäî ÌòÑÏÉÅÏù¥ ÏûàÏóàÏäµÎãàÎã§.
    
-   **Í∑ºÎ≥∏ ÏõêÏù∏:** ÏÑúÎ≤ÑÏóêÏÑú `Set-Cookie` Ìó§ÎçîÎ•º ÌÜµÌï¥ JWT ÌÜ†ÌÅ∞ÏùÑ Î≥¥ÎÇ¥ÏßÄÎßå, Î∏åÎùºÏö∞Ï†ÄÍ∞Ä Ïø†ÌÇ§Î•º ÎÇ¥Î∂ÄÏ†ÅÏúºÎ°ú Ï≤òÎ¶¨ÌïòÏó¨ JavaScriptÏóêÏÑú Ï†ëÍ∑º Í∞ÄÎä•ÌïòÍ≤å ÎßåÎìúÎäî ÏãúÏ†êÍ≥º `main.js`Ïùò Ï¥àÍ∏∞ API Ìò∏Ï∂ú ÏãúÏ†ê ÏÇ¨Ïù¥Ïóê ÌÉÄÏù¥Î∞ç Ï∞®Ïù¥Í∞Ä Î∞úÏÉùÌñàÍ∏∞ ÎïåÎ¨∏ÏûÖÎãàÎã§.
    
-   **Ìï¥Í≤∞ Ï†ÑÎûµ:** `main.js`Ïóê `waitForJWTCookie()`ÎùºÎäî JWT Ïø†ÌÇ§ ÎåÄÍ∏∞ Î°úÏßÅÏùÑ Ï∂îÍ∞ÄÌïòÏó¨ Î∏åÎùºÏö∞Ï†ÄÍ∞Ä Ïø†ÌÇ§Î•º ÏôÑÏ†ÑÌûà Ï≤òÎ¶¨Ìï† ÏãúÍ∞ÑÏùÑ ÌôïÎ≥¥ÌïòÎèÑÎ°ù ÌñàÏäµÎãàÎã§.


## üß† Î∞∞Ïö¥ ÌïµÏã¨ Í∞úÎÖê

-   **JWT Í∏∞Î∞ò Ïù∏Ï¶ù ÏãúÏä§ÌÖúÏùò Ïã¨Ìôî Ïù¥Ìï¥**: `HttpOnly`, `SameSite=Strict`, `Secure` Ïø†ÌÇ§ ÏòµÏÖòÏùò Ïã§Ï†ú Ï†ÅÏö©Í≥º `JWT_CSRF_COOKIE_HTTPONLY` ÏÑ§Ï†ïÏùÑ ÌÜµÌïú CSRF ÌÜ†ÌÅ∞Ïùò JavaScript Ï†ëÍ∑º Ï†úÏñ¥ Î©îÏª§ÎãàÏ¶òÏùÑ Î™ÖÌôïÌûà Ïù¥Ìï¥ÌïòÏó¨ **XSSÏôÄ CSRF Í≥µÍ≤©ÏùÑ ÎèôÏãúÏóê Î∞©Ïñ¥ÌïòÎäî Ïù¥Ï§ë Î≥¥Ïïà ÏãúÏä§ÌÖú Íµ¨Ï∂ï**Ïùò Ï§ëÏöîÏÑ±ÏùÑ Ï≤¥ÎìùÌñàÏäµÎãàÎã§.
    
-   **Î≥µÌï©Ï†ÅÏù∏ ÏÑúÎ≤Ñ ÌôòÍ≤ΩÏóêÏÑúÏùò ÎîîÎ≤ÑÍπÖ Ï†ÑÎûµ**: cPanelÍ≥º Í∞ôÏùÄ Ï†úÏïΩÎêú Í≥µÏú† Ìò∏Ïä§ÌåÖ ÌôòÍ≤ΩÏóêÏÑú Î∞úÏÉùÌïòÎäî `Child process was killed`ÏôÄ Í∞ôÏùÄ ÏòàÏ∏° Î∂àÍ∞ÄÎä•Ìïú ÏÑúÎ≤Ñ Î¶¨ÏÜåÏä§ Î¨∏Ï†úÏùò ÏõêÏù∏ÏùÑ Îã§Í∞ÅÎèÑÎ°ú Î∂ÑÏÑùÌïòÍ≥†(Google Analytics OAuth, WordPress API Ìò∏Ï∂ú, Debug Mode ÌôúÏÑ±Ìôî Îì±), **ÌôòÍ≤Ω Î≥ÄÏàò Î∞è ÏΩîÎìú ÏµúÏ†ÅÌôîÎ•º ÌÜµÌïú Ìï¥Í≤∞ Î∞©ÏïàÏùÑ Î™®ÏÉâÌïòÎäî Îä•Î†•**ÏùÑ Í∏∏Î†ÄÏäµÎãàÎã§.
    
-   **Îã§Íµ≠Ïñ¥ PDF ÏÉùÏÑ±Ïùò Ìè∞Ìä∏ Í¥ÄÎ¶¨ Ï§ëÏöîÏÑ±**: `xhtml2pdf`ÏôÄ Í∞ôÏùÄ ÎùºÏù¥Î∏åÎü¨Î¶¨ ÏÇ¨Ïö© Ïãú **Ïö¥ÏòÅÏ≤¥Ï†úÏùò Ìè∞Ìä∏ ÏûêÎèô ÎåÄÏ≤¥ Í∏∞Îä• Î∂ÄÏû¨**Î°ú Ïù∏Ìïú Îã§Íµ≠Ïñ¥ Íπ®Ïßê ÌòÑÏÉÅÏùÑ Ïù∏ÏßÄÌïòÍ≥†, **ÌÜµÌï© Ìè∞Ìä∏(Noto Sans)Î•º ÏßÅÏ†ë Ìè¨Ìï®ÌïòÍ≥† Î™ÖÏãúÏ†ÅÏúºÎ°ú ÏßÄÏ†ïÌïòÎäî Í≤ÉÏù¥ ÌïÑÏàòÏ†ÅÏûÑ**ÏùÑ Ïù¥Ìï¥ÌñàÏäµÎãàÎã§.


## üí° Ïã§Ï†Ñ ÏãúÌñâÏ∞©Ïò§ Î∞è ÌåÅ

-   **`Flask-JWT-Extended` CSRF Î≥¥Ìò∏ ÏÑ§Ï†ïÏùò ÎØ∏Î¨òÌïú Ï∞®Ïù¥**: `JWT_COOKIE_HTTPONLY`ÏôÄ `JWT_CSRF_COOKIE_HTTPONLY` ÏÑ§Ï†ïÏùÑ ÌòºÎèôÌïòÏó¨ CSRF ÌÜ†ÌÅ∞ Ï†ëÍ∑º Î¨∏Ï†úÎ•º Í≤™ÏóàÏäµÎãàÎã§. **Access TokenÏùÄ HttpOnlyÎ°ú Ïú†ÏßÄÌïòÎêò, CSRF ÌÜ†ÌÅ∞ÏùÄ JavaScriptÏóêÏÑú Ï†ëÍ∑º Í∞ÄÎä•ÌïòÎèÑÎ°ù `JWT_CSRF_COOKIE_HTTPONLY = False`Î°ú Î™ÖÌôïÌûà ÏÑ§Ï†ï**Ìï¥Ïïº Ìï©ÎãàÎã§.
    
-   **`Flask-JWT-Extended` ÌÜ†ÌÅ∞ ÌÅ¥Î†àÏûÑ ÌïÑÌÑ∞ÎßÅÏùò ÌïÑÏöîÏÑ±**: Refresh TokenÏúºÎ°ú ÏÉàÎ°úÏö¥ Access TokenÏùÑ ÏÉùÏÑ±Ìï† Îïå `type` ÌÅ¥Î†àÏûÑÏù¥ Î≥µÏÇ¨ÎêòÏñ¥ "Only non-refresh tokens are allowed" ÏóêÎü¨Í∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. **`RESERVED_CLAIMS`Î•º ÌôúÏö©ÌïòÏó¨ JWT ÏòàÏïΩ ÌÅ¥Î†àÏûÑÏù¥ Ïû¨Î∞úÍ∏â ÌÜ†ÌÅ∞Ïóê Î∂àÌïÑÏöîÌïòÍ≤å Ìè¨Ìï®ÎêòÏßÄ ÏïäÎèÑÎ°ù ÌïÑÌÑ∞ÎßÅ**ÌïòÎäî Í≤ÉÏù¥ Ï§ëÏöîÌï©ÎãàÎã§.
    
-   **`xhtml2pdf` ÌôòÍ≤Ω ÎèÖÎ¶ΩÏ†Å ÏµúÏ†ÅÌôî**: PDF ÏÉùÏÑ± Ïãú `width: 100%` Í∞ôÏùÄ CSS Î∞±Î∂ÑÏú®Ïù¥ Ïò¨Î∞îÎ•¥Í≤å Ï†ÅÏö©ÎêòÏßÄ ÏïäÍ±∞ÎÇò Ìè∞Ìä∏ Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌï† Ïàò ÏûàÏäµÎãàÎã§. **HTML Ï†ÑÏ≤òÎ¶¨ Í≥ºÏ†ïÏóêÏÑú Î∞±Î∂ÑÏú®ÏùÑ Í≥†Ï†ï ÌÅ¨Í∏∞(Ïòà: `mm`)Î°ú Î≥ÄÌôòÌïòÍ≥†, Îã§Íµ≠Ïñ¥ ÏßÄÏõêÏù¥ Í∞ÄÎä•Ìïú ÌäπÏ†ï Ìè∞Ìä∏(Ïòà: Noto Sans)Î•º Î™ÖÏãúÏ†ÅÏúºÎ°ú ÏßÄÏ†ïÌïòÏó¨ ÌôòÍ≤ΩÏóê Íµ¨Ïï†Î∞õÏßÄ ÏïäÎäî ÏïàÏ†ïÏ†ÅÏù∏ PDF ÏÉùÏÑ±**ÏùÑ ÌôïÎ≥¥Ìï¥Ïïº Ìï©ÎãàÎã§.
    
-   **ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏-ÏÑúÎ≤Ñ Ï¥àÍ∏∞Ìôî ÌÉÄÏù¥Î∞ç Î¨∏Ï†ú Ìï¥Í≤∞**: Ï≤´ Ï†ëÏÜç Ïãú API Ìò∏Ï∂úÏù¥ Ïã§Ìå®ÌïòÎäî Î¨∏Ï†úÎäî ÏÑúÎ≤ÑÏóêÏÑú Ïø†ÌÇ§Î•º Î∞úÌñâÌïòÍ≥† Î∏åÎùºÏö∞Ï†ÄÍ∞Ä Ïù¥Î•º Ï≤òÎ¶¨ÌïòÎäî ÏãúÍ∞Ñ Ï∞®Ïù¥ÏóêÏÑú ÎπÑÎ°ØÎê©ÎãàÎã§. **JavaScriptÏóêÏÑú `document.cookie`Î•º ÌôïÏù∏ÌïòÎ©∞ ÌïÑÏöîÌïú Ïø†ÌÇ§Í∞Ä Î°úÎìúÎê† ÎïåÍπåÏßÄ ÎåÄÍ∏∞ÌïòÎäî Î°úÏßÅ(`waitForJWTCookie`)ÏùÑ Íµ¨ÌòÑ**ÌïòÏó¨ Ï¥àÍ∏∞ API Ìò∏Ï∂úÏùò ÏïàÏ†ïÏÑ±ÏùÑ ÎÜíÏùº Ïàò ÏûàÏäµÎãàÎã§.


## üîú Îã§Ïùå ÌïôÏäµ Î∞©Ìñ•

-   **PDF Îã§Íµ≠Ïñ¥ Ìè∞Ìä∏ ÏßÄÏõê ÏãúÏä§ÌÖú Íµ¨Ï∂ï ÏôÑÎ£å**: Ïò§Îäò Í≥ÑÌöçÎêú Noto Sans Ìè∞Ìä∏ ÌååÏùºÏùÑ ÏÑúÎ≤ÑÏóê ÏóÖÎ°úÎìúÌïòÍ≥† `pdf_generator.py`Î•º ÏàòÏ†ïÌïòÏó¨ **Îã§Íµ≠Ïñ¥(ÌïúÍµ≠Ïñ¥, Ï§ëÍµ≠Ïñ¥ Ìè¨Ìï®) ÌÖçÏä§Ìä∏Í∞Ä Íπ®ÏßÄÏßÄ ÏïäÍ≥† PDFÏóê Ïò¨Î∞îÎ•¥Í≤å ÌëúÏãú**ÎêòÎèÑÎ°ù Íµ¨ÌòÑÌïòÍ≥† ÌÖåÏä§Ìä∏Ìï† Í≤ÉÏûÖÎãàÎã§.
    
-   **cPanel ÏÑúÎ≤Ñ Î¶¨ÏÜåÏä§ ÏµúÏ†ÅÌôî Í≤∞Í≥º ÌÖåÏä§Ìä∏**: Ïò§Îäò Ï†ÅÏö©Ìïú ÎîîÎ≤ÑÍ∑∏ Î™®Îìú, WordPress API Ìò∏Ï∂ú ÏÑ§Ï†ï, Î°úÍπÖ Î†àÎ≤® Ï°∞Ï†ï Îì±Ïùò Î≥ÄÍ≤Ω ÏÇ¨Ìï≠Ïù¥ **cPanel ÌôòÍ≤ΩÏóêÏÑú Ïã§Ï†úÎ°ú ÏÑúÎ≤Ñ Î¶¨ÏÜåÏä§ ÏÇ¨Ïö©ÎüâÏùÑ Ï§ÑÏù¥Í≥† ÌîÑÎ°úÏÑ∏Ïä§ ÌÇ¨ÎßÅ Î¨∏Ï†úÎ•º Ìï¥Í≤∞ÌïòÎäîÏßÄ** Ï≤†Ï†ÄÌûà ÌÖåÏä§Ìä∏ÌïòÍ≥† Í≤ÄÏ¶ùÌï† Í≤ÉÏûÖÎãàÎã§.
    
-   **PDF Ïª§Î≤Ñ Ïù¥ÎØ∏ÏßÄ ÎèôÏ†Å Î≥ÄÍ≤Ω ÏãúÏä§ÌÖú Í∞úÎ∞ú Ï∞©Ïàò**: Í∞úÎ∞ú ÏÑ†ÏûÑÏùò ÌîºÎìúÎ∞±ÏùÑ Î∞òÏòÅÌïòÏó¨ WordPressÏóêÏÑú Ïù¥ÎØ∏ÏßÄÎ•º Í∞ÄÏ†∏ÏôÄ PDF Ïª§Î≤Ñ Î∞∞Í≤ΩÏúºÎ°ú ÏÇ¨Ïö©ÌïòÎäî **ÎèôÏ†Å Ïª§Î≤Ñ Ïù¥ÎØ∏ÏßÄ ÏãúÏä§ÌÖú Íµ¨ÌòÑÏùÑ ÏãúÏûë**ÌïòÍ≥†, Í∏∞Ï°¥ CSS Î∞∞Í≤ΩÏÉâ Î∞©ÏãùÏùÑ ÎåÄÏ≤¥Ìï† Í≤ÉÏûÖÎãàÎã§.
    
-   **AI ÏöîÏïΩ Î∞è PDF ÌÖçÏä§Ìä∏ ÏΩòÌÖêÏ∏† ÌîºÎìúÎ∞± Î∞òÏòÅ**: Ïù¥Ï†ÑÏóê Î∞õÏùÄ AI ÏöîÏïΩ Í∏∞Îä• Í∞úÏÑ†ÏÇ¨Ìï≠Í≥º PDF ÎÇ¥ ÌÖçÏä§Ìä∏ ÏΩòÌÖêÏ∏† ÌíàÏßà Ìñ•ÏÉÅÏóê ÎåÄÌïú ÌîºÎìúÎ∞±ÏùÑ Íµ¨Ï≤¥Ï†ÅÏúºÎ°ú ÌôïÏù∏ÌïòÍ≥† Î∞òÏòÅ ÏûëÏóÖÏùÑ ÏßÑÌñâÌï† Í≤ÉÏûÖÎãàÎã§.
    
-   **Flask Ïï± Î∞è WP ÌÜµÌï© ÏµúÏ¢Ö ÌÖåÏä§Ìä∏**: Î™®Îì† Í∏∞Îä• Íµ¨ÌòÑÏù¥ ÏôÑÎ£åÎêòÎ©¥, WP Î°úÍ∑∏Ïù∏ Ïó∞Îèô Î∞è Flask Ïï±Ïùò Î™®Îì† Í∏∞Îä•Ïóê ÎåÄÌïú ÌÜµÌï© ÌÖåÏä§Ìä∏Î•º ÏßÑÌñâÌïòÏó¨ ÏµúÏ¢Ö ÏïàÏ†ïÏÑ±ÏùÑ ÌôïÎ≥¥Ìï† Í≤ÉÏûÖÎãàÎã§.
